<!DOCTYPE html>
<html lang="en">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="{{ url_for('static', filename = 'sass/main.css') }}" type="text/css">
    <link rel="stylesheet" href="{{ url_for('static', filename = 'sass/pages/assignclass.css') }}" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css"
        integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<style>
    #decline__button{
        border-radius: 5px;
        padding: 0.5rem;
        border: none;
        background-color: red;
        color:white;
        font-weight: 600;
        letter-spacing: 1px;
    }
    #decline__button:hover{
       cursor: pointer;
    }
    #decline__button:focus{
       outline: none;
    }
    #approve__button{
        border-radius: 5px;
        padding: 0.5rem;
        border: none;
        background-color: #55ce63;
        color:white;
        font-weight: 600;
        letter-spacing: 1px;
    }
    #approve__button:hover{
       cursor: pointer;
    }
    #approve__button:focus{
       outline: none;
    }
</style>
<script>
    function opennavbar(){
        $('.navbar').toggleClass('show-navbar');
        $('.nav__icon').toggleClass('displaynone');
    }
    function showsublist(param , value){
        $('ul', param).toggleClass(value);
    }
    function logout(){
        localStorage.clear();
        window.location.href = '/';
    } 
    function loadnavbar(){
      priority = localStorage.getItem('faculty_type');
            var temp = `
            <ul class="nav__ul">
                    <li class="nav__li" onclick="window.location.href = 'home' "><i class="fa fal fa-home displaynone nav__icon"></i>&nbsp;&nbsp;Home</li>
                    <li class="nav__li teacherli" onclick="showsublist($(this), 'show')"><i class="fa fal fa-chalkboard-teacher displaynone nav__icon"></i>&nbsp;&nbsp;Professor<span></span>
                        <ul class="sub ">
                            <!--Add show on click of teacherli-->`;
            if(priority > 2){
                temp += `
                    <li class="sub__li" onclick="window.location.href = 'teachers'"><i class="fa fal fa-users displaynone nav__icon"></i>&nbsp;&nbsp;View All Teachers</li>
                    <li class="sub__li" onclick="window.location.href = 'approval'"><i class="fa fal fa-thumbs-up displaynone nav__icon"></i>&nbsp;&nbsp;Approve Register Request</li>
                    <li class="sub__li" onclick="window.location.href = 'assignclass'"><i class="fa fal fa-hand-point-right displaynone nav__icon"></i>&nbsp;&nbsp;Assign Class teachers</li>
                `;
            }
            if(priority > 1){
                temp += `
                <li class="sub__li" onclick="window.location.href = 'assignteacher'"><i class="fa fal fa-edit displaynone nav__icon"></i>&nbsp;&nbsp;Add subjects</li>
                `; 
            }
            temp += `</ul>
                    </li>
                    <li class="nav__li studentli" onclick="showsublist($(this), 'show')"><div class="student"><i class="fa fal fa-user-graduate displaynone nav__icon"></i>&nbsp;&nbsp;Students</div>
                        <ul class="sub studentlist">`;
            if(priority > 1){
                temp += `
                    <li class="sub__li" onclick=" window.location.href = 'addstudent'"><i class="fa fal fa-graduation-cap displaynone nav__icon"></i>&nbsp;&nbsp;Add students</li>
                `;
            }
            temp += `
                            <li class="sub__li" onclick=" window.location.href = 'addattendance'"><i class="fa fal fa-clock displaynone nav__icon"></i>&nbsp;&nbsp;Manage attendace</li>
                            <li class="sub__li" onclick=" window.location.href = 'iamarks'"><i class="fa fal fa-book-open displaynone nav__icon"></i>&nbsp;&nbsp;Manage IA marks</li>
                        </ul>
                    </li>
                </ul>
            `;
            $('.navbar').html(temp);
    }
</script>
<script>
     $(document).ready(function()
            {
                var faculty_id = localStorage.getItem('faculty_id');
            var authkey = localStorage.getItem('authkey');
            var data = {
                'authkey': authkey,
                'faculty_id': faculty_id,
                'check_approval':1
                };
                if(data['authkey'] == null || data['faculty_id'] == null){
                window.location.href = "/";
            }
                // console.log(localStorage.getItem('faculty_type'));
                 if (localStorage.getItem('faculty_type') < 3)
                {
                    window.location.href = 'home'
                }
                loadnavbar();
                $.ajax(
                {
                    type: "POST",
                    url: "get_all_faculty",
                    dataType: 'Json',
                    contentType: 'application/json',
                    data: JSON.stringify(data),
                    processData: false,
                    success :function(ret_obj){
                        console.log("tsting");
                        console.log(ret_obj['data']);
                        var d = ""; 
                        for(i=0;i<ret_obj['data'].length;i++)
                        {
                         d += `<div class="allteachers__person" >      
                                <div class="allteachers__dots">
                                    <i class="fa fa-ellipsis-v fa-1x"></i>
                                </div>
                                <div class="allteachers__pic">
                                    <img src="data:image/jpg;base64, `+ ret_obj['data'][i][3] + `" alt="" class="header__logout__img" >
                                </div>
                                <div class="allteachers__name">
                                    <p>`+ret_obj['data'][i][1]+`</p>
                                    <br>
                                    <p> Email : ` +ret_obj['data'][i][4]+`</p>
                                    <br>
                                    <p> Department : `+ret_obj['data'][i][2]+`</p>
                                </div>
                                <button id = "decline__button" onclick='approvefunction(`+ret_obj['data'][i][0]+`,0)''">Decline</button>
                                <button id = "approve__button" onclick='approvefunction(`+ret_obj['data'][i][0]+`,1)'">Approve</button>
                            </div>
                            `;
                        }
                        $('.allteachers__details').html(d);
                    }
                   
                });
            
            })
        function approvefunction(f_id,status)
        {
            console.log(f_id);
            var faculty_id = localStorage.getItem('faculty_id');
            var authkey = localStorage.getItem('authkey');
            var data = {
                'authkey': authkey,
                'faculty_id': faculty_id,
                'f_id':f_id,
                'status' : status,
                };
            $.ajax(
                {
                    type: "POST",
                    url: "approve__decline",
                    dataType: 'Json',
                    contentType: 'application/json',
                    data: JSON.stringify(data),
                    processData: false,
                    success :function(ret_obj){
                        console.log(ret_obj);
                    }
                });
        }
</script>
<body>
    <div class="container">
        <header class="header">
            <img src="{{ url_for('static' , filename = 'images/logo.png')}}" alt="" class="header__collegelogo">
            <div class="header__content1">
                <button class="nav-btn" onclick="opennavbar()"><i class="fa fa-bars fa-2x headericon"></i></button>
                <h3 class="header__heading">Approve Registration</h3>
            </div>
            <div class="header__content2">
                <!-- <form action="" class="header__form search-show">
                    <input type="search" class="header__search" placeholder="Search here">
                    <button class="header__search-btn"><i class="fa fa-search fa-1x icon-sbtn"></i></button>
                </form> -->
                <div class="btn-shownone">
                    <i class="fa fa-search fa-2x "></i>       <!--Make the btn-shownone to display block on click-->
                </div>
                
                <div class="header__logout">
                    <div class="header__logout__group" onclick="showsublist($(this), 'header__logout__listshow')">
                        <div class="header__logout__pic">
                            <img src="../images/user-3.jpg" alt="" class="header__logout__img">
                        </div>
                        <div class="header__dots" ><i class="fa fa-ellipsis-v fa-1x"></i>
                            <ul class="header__logout__list ">   <!--Add header__logout__listshow on click of header__logout__group-->
                                <li><a href="home">My profile</a></li>
                                <!-- <li><a href="#">Settings</a></li> -->
                                <li><a href="#">Log out</a></li>
                            </ul>   
                        </div>
                        <p class="header__logout__name"><span class="header__logout__span">Admin</span>    
                            <ul class="header__logout__list ">   <!--Add header__logout__listshow on click of header__logout__group-->
                                <li><a href="home">My profile</a></li>
                                <!-- <li><a href="#">Settings</a></li> -->
                                <li><div onclick="logout()">Log out</div></li>
                            </ul>
                        </p>
                    </div>
                </div>
            </div>
        </header>
        <section class="section">
            <div class="navbar ">
                <!--Add show-navbar on click of nav button-->
                <ul class="nav__ul">
                    <li class="nav__li"><a href="">home</a> </li>
                    <li class="nav__li teacherli"><a href="" class="teacher">Professor</a> <span></span>
                        <ul class="sub ">
                            <!--Add show on click of teacherli-->
                            
                            <li class="sub__li" onclick="window.location.href = 'assignclass'">Class teachers</li>
                            <li class="sub__li" onclick="window.location.href = 'assignteacher'">Add subjects</li>
                        </ul>
                    </li>
                    <li class="nav__li studentli"><a href="" class="student">Students</a>
                        <ul class="sub studentlist">
                            <!--Add show on click of studentli-->
                            <li class="sub__li" onclick=" window.location.href = 'addstudent'"> Add students</li>
                            
                            <li class="sub__li" onclick=" window.location.href = 'addattendance'">Manage attendace</li>
                            <li class="sub__li" onclick=" window.location.href = 'iamarks'"> Manage IA marks</li>
                        </ul>
                    </li>
                </ul>
            </div>
            <div class="content">
                <div class="allteachers">
                    <div class="allteachers__details">
                        <!-- <div class="allteachers__person">      
                          
                        </div> -->
                    </div>    
                    
                </div>
            </div>
        </section>
    </div>
</body>
</html>